rule: L065

test_fail_simple_fix_union_all_before:
  fail_str: |
      SELECT 'a' UNION ALL
      SELECT 'b'
  fix_str: |
      SELECT 'a'
      UNION ALL
      SELECT 'b'

test_fail_simple_fix_union_all_after:
  fail_str: |
      SELECT 'a'
      UNION ALL SELECT 'b'
  fix_str: |
      SELECT 'a'
      UNION ALL
      SELECT 'b'

test_fail_simple_fix_union_all_before_and_after:
  fail_str: |
      SELECT 'a' UNION ALL SELECT 'b'
  fix_str: |
      SELECT 'a'
      UNION ALL
      SELECT 'b'

test_pass_multiple_newlines_are_allowed:
  pass_str: |
      SELECT 'a'


      UNION ALL


      SELECT 'b'

test_fail_fix_works_in_subqueries:
  fail_str: |
      SELECT * FROM (
          SELECT 'g' UNION ALL
          SELECT 'h'
          UNION ALL SELECT 'j'
      )
  fix_str: |
      SELECT * FROM (
          SELECT 'g'
      UNION ALL
          SELECT 'h'
          UNION ALL
      SELECT 'j'
      )

test_fail_simple_fix_union_before_and_after:
  fail_str: |
      SELECT 'a' UNION SELECT 'b'
  fix_str: |
      SELECT 'a'
      UNION
      SELECT 'b'

test_fail_simple_fix_intersect_before_and_after:
  fail_str: |
      SELECT 'a' INTERSECT SELECT 'b'
  fix_str: |
      SELECT 'a'
      INTERSECT
      SELECT 'b'

test_fail_simple_fix_except_before_and_after:
  fail_str: |
      SELECT 'a' EXCEPT SELECT 'b'
  fix_str: |
      SELECT 'a'
      EXCEPT
      SELECT 'b'

test_fail_simple_fix_minus_before_and_after:
  fail_str: |
      SELECT 'a' EXCEPT SELECT 'b'
  fix_str: |
      SELECT 'a'
      EXCEPT
      SELECT 'b'

test_fail_simple_fix_bigquery_intersect_distinct_before_and_after:
  fail_str: |
      SELECT 'a' INTERSECT DISTINCT SELECT 'b'
  fix_str: |
      SELECT 'a'
      INTERSECT DISTINCT
      SELECT 'b'
  configs:
    core:
      dialect: bigquery
